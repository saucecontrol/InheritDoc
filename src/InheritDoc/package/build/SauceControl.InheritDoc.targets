<?xml version="1.0" encoding="utf-8"?>
<Project>

	<PropertyGroup>
		<InheritDocEnabled Condition="'$(InheritDocEnabled)'=='' and '$(Configuration)'!='debug' and '$(DesignTimeBuild)'!='true' and '$(BuildingForLiveUnitTesting)'!='true'">true</InheritDocEnabled>
		<CopyDocumentationFileToOutputDirectory Condition=" '$(InheritDocEnabled)' == 'true' ">false</CopyDocumentationFileToOutputDirectory>
	</PropertyGroup>

	<ItemGroup Condition=" '$(InheritDocEnabled)' == 'true' ">
		<!-- Force intermediate documentation file -->
		<DocFileItem Remove="$(DocumentationFile)"/>
		<DocFileItem Include="$(IntermediateOutputPath)$(AssemblyName).xml"/>
	</ItemGroup>

	<Target Name="_InheritDocPostProcess" AfterTargets="CoreCompile" DependsOnTargets="ResolveAssemblyReferences;CoreCompile;_CheckForCompileOutputs" Inputs="@(DocFileItem)" Outputs="@(FinalDocFile)" Condition="'$(InheritDocEnabled)'=='true' and '$(_DocumentationFileProduced)'=='true'">

		<Message Importance="normal" Text="InheritDoc processing file: @(DocFileItem -> '%(Filename)%(Extension)')" />

		<ItemGroup>
			<FileWrites Condition="Exists('@(FinalDocFile)')" Include="@(FinalDocFile)" />
			<InheritDocReference Condition="'$(TargetFramework)'=='netstandard2.0'" Include="$(_InheritDocNetStandardFallback)" />
		</ItemGroup>

		<InheritDocTask AssemblyPath="@(IntermediateAssembly)" InDocPath="@(DocFileItem)" OutDocPath="@(FinalDocFile)" RefAssemblyPaths="@(_ResolveAssemblyReferenceResolvedFiles)" AdditionalDocPaths="@(InheritDocReference)" NoWarn="$(NoWarn)" TrimLevel="$(InheritDocTrimLevel)" />

	</Target>

</Project>
